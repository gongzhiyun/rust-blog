<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="470" viewBox="0 0 800 470" xmlns="http://www.w3.org/2000/svg">
<rect width="800" height="470" fill="#f8f9fa" rx="10"/>
  <g transform="translate(400, 45)">
    <text font-family="JetBrains Mono, monospace" font-size="22" font-weight="bold" fill="#333333" text-anchor="middle">结构体内存对齐与字段重排</text>
    <text y="28" font-family="JetBrains Mono, monospace" font-size="14" fill="#78909c" text-anchor="middle">Struct Alignment &amp; Reordering</text>
  </g>
<!-- Scenario 1: repr(C) -->
<g transform="translate(50, 110)">
<text x="0" y="20" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#333333">1. 未优化布局 (C 语言风格 / repr(C))</text>
<text x="0" y="45" font-family="JetBrains Mono, monospace" font-size="13" fill="#78909c">struct MyData { a: u8, b: u32, c: u8 }</text>
<g transform="translate(0, 75)">
<!-- Byte Grid lines (Background) -->
<path d="M 40 0 L 40 45 M 80 0 L 80 45 M 120 0 L 120 45 M 200 0 L 200 45 M 240 0 L 240 45 M 280 0 L 280 45 M 360 0 L 360 45 M 400 0 L 400 45 M 440 0 L 440 45" stroke="#e0e0e0" stroke-width="1"/>
<!-- Offset Labels (Aligned to left edge of bytes) -->
<text x="0" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">0</text>
<text x="40" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">1</text>
<text x="160" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">4</text>
<text x="320" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">8</text>
<text x="360" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">9</text>
<text x="480" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">12</text>
<!-- a: u8 (Offset 0) -->
<rect x="0" y="0" width="40" height="45" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
<text x="20" y="28" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#1565c0" text-anchor="middle">a</text>
<!-- Padding (Offset 1-3) -->
<rect x="40" y="0" width="120" height="45" fill="#ffebee" stroke="#ef5350" stroke-width="1" stroke-dasharray="4,4" fill-opacity="0.6"/>
<text x="100" y="28" font-family="JetBrains Mono, monospace" font-size="12" fill="#c62828" text-anchor="middle">Pad (3B)</text>
<!-- b: u32 (Offset 4-7) -->
<rect x="160" y="0" width="160" height="45" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
<text x="240" y="28" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#1565c0" text-anchor="middle">b (u32)</text>
<!-- c: u8 (Offset 8) -->
<rect x="320" y="0" width="40" height="45" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
<text x="340" y="28" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#1565c0" text-anchor="middle">c</text>
<!-- Padding (Offset 9-11) -->
<rect x="360" y="0" width="120" height="45" fill="#ffebee" stroke="#ef5350" stroke-width="1" stroke-dasharray="4,4" fill-opacity="0.6"/>
<text x="420" y="28" font-family="JetBrains Mono, monospace" font-size="12" fill="#c62828" text-anchor="middle">Pad (3B)</text>
</g>
<text x="240" y="155" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#333333" text-anchor="middle">总计大小: 12 字节 (利用率: 50%)</text>
</g>
<!-- Arrow Section -->
<g transform="translate(620, 200)">
<path d="M 0 0 L 0 80" stroke="#9c27b0" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
<text x="15" y="45" font-family="JetBrains Mono, monospace" font-size="13" font-weight="bold" fill="#9c27b0">编译器重排优化</text>
</g>
<!-- Scenario 2: repr(Rust) -->
<g transform="translate(50, 300)">
<text x="0" y="20" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#4caf50">2. 优化后布局 (默认 repr(Rust))</text>
<text x="0" y="45" font-family="JetBrains Mono, monospace" font-size="13" fill="#78909c">编译器将字段重排为: b(u32), a(u8), c(u8)</text>
<g transform="translate(0, 75)">
<!-- Byte Grid lines (Background) -->
<path d="M 40 0 L 40 45 M 80 0 L 80 45 M 120 0 L 120 45 M 200 0 L 200 45 M 240 0 L 240 45 M 280 0 L 280 45" stroke="#e0e0e0" stroke-width="1"/>
<!-- Offset Labels -->
<text x="0" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">0</text>
<text x="160" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">4</text>
<text x="200" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">5</text>
<text x="240" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">6</text>
<text x="320" y="-8" font-family="JetBrains Mono, monospace" font-size="11" fill="#90a4ae" text-anchor="start">8</text>
<!-- b: u32 (Offset 0-3) -->
<rect x="0" y="0" width="160" height="45" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
<text x="80" y="28" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#2e7d32" text-anchor="middle">b (u32)</text>
<!-- a: u8 (Offset 4) -->
<rect x="160" y="0" width="40" height="45" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
<text x="180" y="28" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#2e7d32" text-anchor="middle">a</text>
<!-- c: u8 (Offset 5) -->
<rect x="200" y="0" width="40" height="45" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
<text x="220" y="28" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#2e7d32" text-anchor="middle">c</text>
<!-- Padding (Offset 6-7) -->
<rect x="240" y="0" width="80" height="45" fill="#ffebee" stroke="#ef5350" stroke-width="1" stroke-dasharray="4,4" fill-opacity="0.6"/>
<text x="280" y="28" font-family="JetBrains Mono, monospace" font-size="12" fill="#c62828" text-anchor="middle">Pad (2B)</text>
</g>
<text x="160" y="155" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#333333" text-anchor="middle">总计大小: 8 字节 (利用率: 75%)</text>
</g>
<defs>
<marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
<polygon points="0 0, 10 3.5, 0 7" fill="#9c27b0" />
</marker>
</defs>
</svg>