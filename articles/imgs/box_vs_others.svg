<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="550" viewBox="0 0 900 550" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision">
<rect x="0" y="0" width="900" height="550" rx="12" fill="#f8f9fa" stroke="#e0e0e0" stroke-width="1"/>
<text x="450" y="35" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="22" font-weight="bold" fill="#333333">Rust 智能指针与集合内存布局对比</text>
<text x="450" y="60" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#78909c">Box&lt;T&gt; vs Rc&lt;T&gt; vs Vec&lt;T&gt;</text>

<!-- Common Definitions -->
<defs>
  <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
    <polygon points="0 0, 10 3.5, 0 7" fill="#ff9800"/>
  </marker>
</defs>

<!-- Box Section -->
<g transform="translate(40, 90)">
  <rect x="0" y="0" width="260" height="420" rx="10" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
  <rect x="0" y="0" width="260" height="40" rx="10 10 0 0" fill="#e3f2fd"/>
  <text x="130" y="25" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#0d47a1">Box&lt;T&gt;</text>
  
  <!-- Stack (Aligned height 150) -->
  <rect x="20" y="60" width="220" height="150" rx="6" fill="#f1f8ff" stroke="#2196f3" stroke-width="1.5"/>
  <text x="35" y="82" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#0d47a1">Stack (栈)</text>
  <g transform="translate(30, 110)">
    <rect x="0" y="0" width="200" height="45" rx="4" fill="#ffffff" stroke="#2196f3" stroke-width="1"/>
    <text x="100" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#333333">ptr: 指针</text>
    <text x="100" y="36" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="10" fill="#78909c">8 bytes</text>
  </g>
  
  <!-- Heap (Aligned y=230, height 120) -->
  <rect x="20" y="230" width="220" height="120" rx="6" fill="#e8f5e9" stroke="#4caf50" stroke-width="1.5"/>
  <text x="35" y="252" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#1b5e20">Heap (堆)</text>
  <rect x="30" y="265" width="200" height="70" rx="4" fill="#ffffff" stroke="#4caf50" stroke-width="1"/>
  <text x="130" y="305" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#333333">Data: T</text>
  
  <!-- Pointer (Centered) -->
  <path d="M 130 155 L 130 230" stroke="#ff9800" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Desc -->
  <text x="130" y="385" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">独占所有权</text>
  <text x="130" y="405" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">最简单的堆分配</text>
</g>

<!-- Rc Section -->
<g transform="translate(320, 90)">
  <rect x="0" y="0" width="260" height="420" rx="10" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
  <rect x="0" y="0" width="260" height="40" rx="10 10 0 0" fill="#f3e5f5"/>
  <text x="130" y="25" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#4a148c">Rc&lt;T&gt;</text>
  
  <!-- Stack (Aligned height 150) -->
  <rect x="20" y="60" width="220" height="150" rx="6" fill="#fcf3ff" stroke="#9c27b0" stroke-width="1.5"/>
  <text x="35" y="82" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#4a148c">Stack (栈)</text>
  <g transform="translate(30, 110)">
    <rect x="0" y="0" width="200" height="45" rx="4" fill="#ffffff" stroke="#9c27b0" stroke-width="1"/>
    <text x="100" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#333333">ptr: 指针</text>
    <text x="100" y="36" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="10" fill="#78909c">8 bytes</text>
  </g>
  
  <!-- Heap (Aligned y=230, height 120) -->
  <rect x="20" y="230" width="220" height="120" rx="6" fill="#e8f5e9" stroke="#4caf50" stroke-width="1.5"/>
  <text x="35" y="252" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#1b5e20">Heap (堆: 共享内存块)</text>
  <rect x="30" y="265" width="200" height="75" rx="4" fill="#ffffff" stroke="#4caf50" stroke-width="1"/>
  <g transform="translate(40, 275)">
    <text x="0" y="12" font-family="JetBrains Mono, monospace" font-size="10" fill="#9c27b0">strong: Cell&lt;usize&gt;</text>
    <text x="0" y="28" font-family="JetBrains Mono, monospace" font-size="10" fill="#9c27b0">weak:   Cell&lt;usize&gt;</text>
    <line x1="-10" y1="35" x2="190" y2="35" stroke="#e0e0e0" stroke-width="1"/>
    <text x="90" y="55" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#333333">value: T</text>
  </g>
  
  <!-- Pointer (Centered) -->
  <path d="M 130 155 L 130 230" stroke="#ff9800" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Desc -->
  <text x="130" y="385" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">共享所有权</text>
  <text x="130" y="405" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">非线程安全引用计数</text>
</g>

<!-- Vec Section -->
<g transform="translate(600, 90)">
  <rect x="0" y="0" width="260" height="420" rx="10" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
  <rect x="0" y="0" width="260" height="40" rx="10 10 0 0" fill="#e8f5e9"/>
  <text x="130" y="25" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="16" font-weight="bold" fill="#1b5e20">Vec&lt;T&gt;</text>
  
  <!-- Stack (Aligned height 150) -->
  <rect x="20" y="60" width="220" height="150" rx="6" fill="#f1f8ff" stroke="#2196f3" stroke-width="1.5"/>
  <text x="35" y="82" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#0d47a1">Stack (栈)</text>
  <g transform="translate(30, 95)">
    <rect x="0" y="0" width="200" height="32" rx="4" fill="#ffffff" stroke="#2196f3" stroke-width="1"/>
    <text x="100" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#333333">ptr: 指针 (8B)</text>
    
    <rect x="0" y="37" width="200" height="32" rx="4" fill="#ffffff" stroke="#2196f3" stroke-width="1"/>
    <text x="100" y="57" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#333333">cap: usize (8B)</text>
    
    <rect x="0" y="74" width="200" height="32" rx="4" fill="#ffffff" stroke="#2196f3" stroke-width="1"/>
    <text x="100" y="94" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#333333">len: usize (8B)</text>
  </g>
  
  <!-- Heap (Aligned y=230, height 120) -->
  <rect x="20" y="230" width="220" height="120" rx="6" fill="#e8f5e9" stroke="#4caf50" stroke-width="1.5"/>
  <text x="35" y="252" font-family="JetBrains Mono, monospace" font-size="12" font-weight="bold" fill="#1b5e20">Heap (堆: 连续空间)</text>
  <g transform="translate(30, 270)">
    <rect x="0" y="0" width="55" height="40" rx="2" fill="#ffffff" stroke="#4caf50" stroke-width="1"/>
    <text x="27.5" y="25" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#333333">T</text>
    <rect x="65" y="0" width="55" height="40" rx="2" fill="#ffffff" stroke="#4caf50" stroke-width="1"/>
    <text x="92.5" y="25" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#333333">T</text>
    <rect x="130" y="0" width="70" height="40" rx="2" fill="#f1f8e9" stroke="#c8e6c9" stroke-dasharray="2,2"/>
    <text x="165" y="25" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="10" fill="#999999">空闲(cap)</text>
    <text x="100" y="65" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="10" fill="#78909c">连续内存布局</text>
  </g>
  
  <!-- Pointer (Centered) -->
  <path d="M 130 127 L 130 230" stroke="#ff9800" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Desc -->
  <text x="130" y="385" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">动态扩容集合</text>
  <text x="130" y="405" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">堆上的连续数组</text>
</g>
</svg>