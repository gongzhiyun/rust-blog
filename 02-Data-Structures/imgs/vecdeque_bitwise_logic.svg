<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="450" viewBox="0 0 800 450" fill="none" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision">
  <rect width="800" height="450" rx="15" fill="#f8f9fa"/>
  <text x="400" y="40" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="22" font-weight="bold" fill="#333333">VecDeque 位运算掩码：2 的幂次魔法</text>
  
  <!-- 场景 1: 向后回绕 (push_back) -->
  <g transform="translate(50, 80)">
    <rect width="340" height="320" rx="12" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="340" height="35" rx="12" fill="#e3f2fd"/>
    <text x="170" y="23" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#1565c0">场景 A: 索引溢出 (8 → 0)</text>
    
    <!-- 逻辑索引 8 -->
    <g transform="translate(20, 60)">
      <text x="0" y="15" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">逻辑索引 (8):</text>
      <rect x="100" y="0" width="200" height="30" rx="4" fill="#f3e5f5" stroke="#9c27b0"/>
      <text x="200" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#6a1b9a">... 0000 1000</text>
    </g>
    
    <!-- 掩码 (Mask) -->
    <g transform="translate(20, 110)">
      <text x="0" y="15" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">掩码 (7):</text>
      <rect x="100" y="0" width="200" height="30" rx="4" fill="#fff8e1" stroke="#ff9800"/>
      <text x="200" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#f57c00">... 0000 0111</text>
    </g>
    
    <!-- 分割线 -->
    <line x1="120" y1="155" x2="300" y2="155" stroke="#333" stroke-width="1" stroke-dasharray="4 2"/>
    <text x="80" y="160" font-family="JetBrains Mono, monospace" font-size="18" font-weight="bold" fill="#333">&amp;</text>
    
    <!-- 物理结果 -->
    <g transform="translate(20, 175)">
      <text x="0" y="15" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">物理索引 (0):</text>
      <rect x="100" y="0" width="200" height="30" rx="4" fill="#e8f5e9" stroke="#4caf50"/>
      <text x="200" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#2e7d32">... 0000 0000</text>
    </g>
    
    <text x="170" y="250" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" fill="#666">当索引达到容量 (8) 时，</text>
    <text x="170" y="270" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" fill="#666">高位被掩码“咔嚓”切掉，</text>
    <text x="170" y="290" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#2e7d32">瞬间回到起点 0</text>
  </g>
  
  <!-- 场景 2: 向前回绕 (push_front) -->
  <g transform="translate(410, 80)">
    <rect width="340" height="320" rx="12" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="340" height="35" rx="12" fill="#fce4ec"/>
    <text x="170" y="23" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" font-weight="bold" fill="#c2185b">场景 B: 负数回绕 (-1 → 7)</text>
    
    <!-- 逻辑索引 -1 -->
    <g transform="translate(20, 60)">
      <text x="0" y="15" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">逻辑索引 (-1):</text>
      <rect x="100" y="0" width="200" height="30" rx="4" fill="#f3e5f5" stroke="#9c27b0"/>
      <text x="200" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#6a1b9a">1111 1111 1111</text>
    </g>
    
    <!-- 掩码 (Mask) -->
    <g transform="translate(20, 110)">
      <text x="0" y="15" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">掩码 (7):</text>
      <rect x="100" y="0" width="200" height="30" rx="4" fill="#fff8e1" stroke="#ff9800"/>
      <text x="200" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#f57c00">... 0000 0111</text>
    </g>
    
    <!-- 分割线 -->
    <line x1="120" y1="155" x2="300" y2="155" stroke="#333" stroke-width="1" stroke-dasharray="4 2"/>
    <text x="80" y="160" font-family="JetBrains Mono, monospace" font-size="18" font-weight="bold" fill="#333">&amp;</text>
    
    <!-- 物理结果 -->
    <g transform="translate(20, 175)">
      <text x="0" y="15" font-family="JetBrains Mono, monospace" font-size="12" fill="#78909c">物理索引 (7):</text>
      <rect x="100" y="0" width="200" height="30" rx="4" fill="#e8f5e9" stroke="#4caf50"/>
      <text x="200" y="20" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="14" fill="#2e7d32">... 0000 0111</text>
    </g>
    
    <text x="170" y="250" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" fill="#666">0 减 1 在补码表示下是全 1，</text>
    <text x="170" y="270" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" fill="#666">经过掩码过滤后，</text>
    <text x="170" y="290" text-anchor="middle" font-family="JetBrains Mono, monospace" font-size="11" font-weight="bold" fill="#2e7d32">自动指向物理末尾 7</text>
  </g>
</svg>
